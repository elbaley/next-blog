+++
title= "Javascript 30 - GÃ¼n 15"
description = "Javascript 30 Challenge Proje 15: LocalStorage ile AlÄ±ÅŸveriÅŸ Listesi"
date= "2023-05-11T02:29:04+03:00"
author = "Furkan"
favorite = false
tags = [

]
categories = [
"Javascript"
]

draft= false
+++

Projenin demosu : [Demo](https://elbaley.github.io/js-30/15/index-solution.html)

BaÅŸlangÄ±Ã§ dosyalarÄ±nÄ± bulabileceÄŸiniz repom: [js-30 | github](https://github.com/elbaley/js-30)

JS ile bugÃ¼ne kadar oluÅŸturduÄŸumuz deÄŸerlerin tamamÄ±nÄ± her sayfa yenilenmesinde kaybediyorduk. BugÃ¼n [Local Storage API](https://furkanleba.com/localstorage-ve-sessionstorage/) kullanarak tarayÄ±ca kalÄ±cÄ± olarak veri saklayacaÄŸÄ±z ve demoda da gÃ¶rÃ¼leceÄŸi gibi bir AlÄ±ÅŸveriÅŸ Listesi projesi geliÅŸtireceÄŸiz.

## BaÅŸlamadan Ã¶nce Local Storage hakkÄ±nda bir not
LocalStorage ile yalnÄ±zca key-value deÄŸerleri saklayabiliriz ve value'muz sadece ve sadece `string` olabilir. DolayÄ±sÄ±yla aÅŸaÄŸÄ±daki gibi bir ekleme iÅŸleminde problem yaÅŸamayÄ±z.
```js
localStorage.setItem('isim','furkan')
localStorage.getItem('isim') // 'furkan'
```
Ancak Ã¶rneÄŸin bir object'i localStorage'a eklemeye Ã§alÄ±ÅŸÄ±rsak;
```js
const ogrenci = {
  isim: 'Furkan',
  yas: 24,
} 
localStorage.setItem('ogrenci',ogrenci);
localStorage.getItem('ogrenci')// '[object Object]'
```
Burada gÃ¶rÃ¼leceÄŸi gibi object localStorage'a kaydedilerken `.toString` metoduyla otomatik olarak stringe dÃ¶nÃ¼ÅŸtÃ¼rÃ¼ldÃ¼ÄŸÃ¼nden doÄŸru bir ÅŸekilde kaydedilmedi. Bu sorunu Ã§Ã¶zmek iÃ§in `JSON.stringify` kullanarak objecti stringe doÄŸru bir ÅŸekilde dÃ¶nÃ¼ÅŸtÃ¼rmeliyiz ve local storage'dan bu deÄŸeri okurdan `JSON.parse` kullanmalÄ±yÄ±z.
```js
const ogrenci = {
  isim: 'Furkan',
  yas: 24,
} 
localStorage.setItem('ogrenci',JSON.stringify(ogrenci));
JSON.parse(localStorage.getItem('ogrenci'));//{isim: 'Furkan', yas: 24}
```

## Javascript Event Delegation Konsepti
Bu projede karÅŸÄ±laÅŸacaÄŸÄ±mÄ±z Ã¶nemli bir konsept ise Event Deleagation. Projemizde bir `ul` etiketimiz var ve iÃ§erisinde alÄ±nacak Ã¼rÃ¼nler `li` etiketiyle oluÅŸturuluyor. Bu Ã¼rÃ¼nler alÄ±ndÄ±ÄŸÄ±nda Ã¼stÃ¼ne tÄ±klanarak iÅŸaretlenecek ancak site ilk aÃ§Ä±ldÄ±ÄŸÄ±nda `li` etiketleri olmadÄ±ÄŸÄ±ndan bunlarÄ± takip etmemmiz mÃ¼mkÃ¼n deÄŸil. Ä°ÅŸte burada `li` elementlerini kapsayan parent'a (yani `ul` elementine) event listener ekliyoruz ve dinlerken tÄ±klanan ilgili elementi anlayabiliyoruz. Basit bir Ã¶rnek ÅŸu olabilir:
```html
<ul id="liste">
  <li>Bana tÄ±klarsan uyarÄ±rÄ±m!</li>
  <button>Bana tÄ±klarsan umrumda olmaz!<button>
</ul>
```
```js
const liste = document.querySelector('#liste');
function uyar(e){
//aÅŸaÄŸÄ±da tiklanan Ã¶ÄŸeyi kontrol ettik eÄŸer li deÄŸilse fonksiyon hiÃ§bir ÅŸey yapmadan sonlanacaktÄ±r.
  if(!e.target.matches('li')) return;
  alert('Bana tÄ±kladÄ±n ve uyarÄ±yorum!') 
} 
liste.addEventListener('click',uyar)
```
Bu Ã¶rnekte her element Ã¶ge iÃ§in ayrÄ± ayrÄ± olay dinleyicisi eklemek yerine, Ã¼st Ã¶geye tek bir olay dinleyicisi ekleyerek iÅŸlemi gerÃ§ekleÅŸtirdik.

## Ã‡Ã¶zÃ¼mÃ¼m

```html
<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="UTF-8">
<title>LocalStorage</title>
<link rel="stylesheet" href="style.css">
<link rel="icon" href="https://fav.farm/ğŸ”¥" />
</head>

<body>

<div class="wrapper">
  <h2>SHOPPING LIST</h2>
  <p></p>
  <ul class="products">
    <li>Loading shopping list...</li>
  </ul>
  <form class="add-items">
    <button type="button" id="clear">Clear</button>
    <input type="text" name="item" placeholder="Item Name" required>
    <input type="submit" value="+ Add Item">
  </form>
</div>

<script>
const addItems = document.querySelector('.add-items');
const itemsList = document.querySelector('.products');
// localStorage'dan items adlÄ± deÄŸiÅŸkeni al, yoksa boÅŸ bir array oluÅŸtur
const items = JSON.parse(localStorage.getItem('items')) || [];
const clearButton = document.querySelector('#clear');

function addItem(e) {
  // varsayÄ±lan olarak form gÃ¶nderildiginde sayfa yenilenecektir bunu engelleyelim
  e.preventDefault();
  // inputa eklenen yeni elemanin deÄŸerini inputu seÃ§ip .value deÄŸerine bakarak alÄ±yoruz
  const text = (this.querySelector('[name=item]')).value;
  // yeni alÄ±nacak Ã¼rÃ¼n iÃ§in bir obje oluÅŸturuyoruz 
  const item = {
    text: text,
    done: false
  }

  // oluÅŸturduÄŸumuz objeyi Ã¼rÃ¼nleri sakladÄ±ÄŸÄ±mÄ±z array'e ekliyoruz.
  items.push(item);
  //GÃ¼ncellenmiÅŸ listeyi gÃ¶stermek iÃ§in populateList fonksiyonunu Ã§aÄŸÄ±rÄ±yoruz
  populateList(items, itemsList);
  // GÃ¼ncellenmiÅŸ items dizisini localStorage'a kaydediyoruz
  localStorage.setItem('items', JSON.stringify(items));
  // formu sÄ±fÄ±rlayalÄ±m 
  this.reset();
}

function toggleDone(e) {
  //TÄ±klanan element input deÄŸilse fonksiyondan Ã§Ä±kÄ±yoruz
  if (!e.target.matches('input')) return;
  const el = e.target;
  // TÄ±klanan Ã¶ÄŸenin 'data-index' Ã¶zelliÄŸinden hangi Ã¶ÄŸe olduÄŸunu belirliyoruz
  const index = el.dataset.index
  // SeÃ§ilen Ã¶ÄŸenin 'done' Ã¶zelliÄŸini tersine Ã§eviriyoruz
  items[index].done = !items[index].done;
  // GÃ¼ncellenmiÅŸ items dizisini localStorage'a kaydediyoruz
  localStorage.setItem('items', JSON.stringify(items));
  // GÃ¼ncellenmiÅŸ listeyi gÃ¶stermek iÃ§in populateList fonksiyonunu Ã§aÄŸÄ±rÄ±yoruz
  populateList(items, itemsList);

}

function clearAll(){
  //localStorage'daki tÃ¼m verileri siliyoruz
  localStorage.setItem('items',JSON.stringify([]))
  // urunleri sakladÄ±ÄŸÄ±mÄ±z listeyi sÄ±fÄ±rlayalÄ±m (items=[] yapamayÄ±z Ã§Ã¼nkÃ¼ const olarak baÅŸlattÄ±k)
  items.length = 0;;
  // sildikten sonra tekrar fonksiyonumuz ile gÃ¶rÃ¼nen listeyi gÃ¼ncelliyoruz
  populateList(items,itemsList);
}

// populateList fonksiyonu bir liste ve hedef element alÄ±yor.
// listedeki her bir obje iÃ§in li ve input elementlerinden oluÅŸan bir HTML hazÄ±rlÄ±yor 
// son olarak hedef elementinin iÃ§indeki HTMLi gÃ¼ncelliyor
// bÃ¶ylece her bir Ã¼rÃ¼n iÃ§in sayfada li elementi oluÅŸturuluyor
function populateList(list = [], element) {
  element.innerHTML = list.map((item, i) => {
    return `
    <li>
      <input type="checkbox" data-index=${i} id="item${i}" ${item.done ? 'checked' : ''}>
      <label for="item${i}">${item.text}</label>
    </li>
    `
  }).join('');
}



addItems.addEventListener('submit', addItem)
itemsList.addEventListener('click', toggleDone)
clearButton.addEventListener('click',clearAll) 
// sayfa yÃ¼klendiÄŸinde Ã¶ÄŸeleri listele
populateList(items, itemsList);
</script>
</body>
</html>
```
